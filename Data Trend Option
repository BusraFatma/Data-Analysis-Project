import time
import pandas as pd
import matplotlib.pyplot as plt
from pymodbus.client.sync import ModbusTcpClient
from openopc import client
from collections import deque


# PLC ile iletişim (Modbus TCP) - Veri Çekme

def get_plc_data(plc_ip, plc_port, register_address):
    client = ModbusTcpClient(plc_ip, port=plc_port)
    client.connect()
    result = client.read_holding_registers(register_address, 2)  # 2 register okuma (örnek)
    data = result.registers
    client.close()
    return data

# SCADA ile iletişim (OPC) - Veri Çekme

def get_scada_data(opc_server, tag_name):
    opc_client = client.OPCClient(opc_server)
    opc_client.connect()
    value = opc_client.read(tag_name)  # Reçeteyi SCADA'dan al
    opc_client.close()
    return value

